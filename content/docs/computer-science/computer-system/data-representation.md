---
title: 数据表示
weight: 100
math: true
---

- **位操作**
    - **基本运算**
        - 与、或、非、异或、左移。
        - 逻辑右移：在高位补 $0$。
        - 算术右移：在高位补充之前的最高位数字。
        - 移位量大于等于字长或小于 $0$ 在 C 语言中是未定义行为。
    - **优先级**
        - 位运算符优先级：
            - 按位非 `~`
            - 左移/右移 `<<` `>>`
            - 按位与 `&`
            - 按位异或 `^`
            - 按位或 `|`
        - 结合算术运算时，算术运算符优先级高于移位运算符。
- **整数**
    - **编码**
        - 二进制位向量：底层储存方式，无编码，以下用 $B$ 表示，记作 $[x_{w - 1}, \dots, x_0]$。
        - 无符号整数：把二进制位向量直接解释为整数，以下用 $U$ 表示。
        - 有符号补码整数：最高位作为符号位，剩下的位储存数或其按位取反加 $1$，以下用 $T$ 表示。
        - C 语言标准不强制有符号整数使用补码，但是几乎都是使用补码。
    - **编码解释**
        - 对于同一个位向量，使用不同的编码，可以有不同的解释的值。
        - 无符号 $B2U_w(\boldsymbol x) = \displaystyle \sum_{i = 0}^w x_i 2^i$。
        - 有符号 $B2T_w(\boldsymbol x) = \displaystyle -x_{w - 1} 2^{w - 1} + \sum_{i = 0}^{w - 1} x_i 2^i$
        - 逆运算用 $U2B(x)$、$T2B(x)$ 表示。
        - 无符号最值 $UMin = 0$，$UMax = 2^{w} - 1$。
        - 补码最值 $TMin = -2^{w - 1}$，$TMax = 2^{w - 1} - 1$。
    - **同大小强制转换**
        - 基本原则：在补码和无符号之间转换，底层的位向量不会变，只是改变编码方式。
        - 补码转无符号 $T2U(x) = B2U(T2B(x)) = x + x_{w - 1} 2^w = \begin{cases} x, & x \ge 0 \\ x + 2^w, & x < 0 \end{cases}$。
            - 非负数和负数转换后，区间顺序颠倒，负数变成大正数。
            - 非负数值不变，$-1$ 转换为 $UMax$，$TMin$ 转换为 $TMax + 1$。
        - 无符号转补码 $U2T(u) = B2T(U2B(u)) = \begin{cases} u, & u < 2^{w - 1} \\ -2^w + u, & u \ge 2^{w - 1} \end{cases}$。
        - 在同一个运算符两侧，如果同时存在无符号和补码，则会转换补码为无符号，再进行比较。
